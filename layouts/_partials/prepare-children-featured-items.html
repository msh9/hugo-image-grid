{{/*
  prepare-children-featured-items: returns a normalized slice of dict items
  representing the featured/cover image for each immediate child of a page.

  Input:
    - parent page/section as .

  Output item shape (normalized):
    - Dictionary of <pageName><base> -->
      - Dictionary of "original" --> Resource, "400w"? --> Resource, "800w"? --> Resource, "alt"? --> Resource, "baseFileName" --> <base>
*/}}

{{ $parent := . }}
{{ $items := dict }}

{{/* Collect immediate children: direct subsections + direct regular pages */}}
{{ $children := slice }}
{{ range $parent.Sections }}{{ $children = $children | append . }}{{ end }}
{{ range $parent.RegularPages }}{{ $children = $children | append . }}{{ end }}

{{ range $children }}
  {{ $child := . }}
  {{ $featuredImage := partial "prepare-feature-image.html" $child }}
  {{ $items = merge $items $featuredImage }}
{{ end }}

{{ return $items }}
